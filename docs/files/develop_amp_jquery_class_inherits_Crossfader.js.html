<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>develop\amp\jquery\class\inherits\Crossfader.js - AMPjs</title>
    <link rel="stylesheet" href="http://yui.yahooapis.com/3.9.1/build/cssgrids/cssgrids-min.css">
    <link rel="stylesheet" href="../assets/vendor/prettify/prettify-min.css">
    <link rel="stylesheet" href="../assets/css/main.css" id="site_styles">
    <link rel="icon" href="../assets/favicon.ico">
    <script src="http://yui.yahooapis.com/combo?3.9.1/build/yui/yui-min.js"></script>
</head>
<body class="yui3-skin-sam">

<div id="doc">
    <div id="hd" class="yui3-g header">
        <div class="yui3-u-3-4">
                <h1><img src="../assets/css/logo.png" title="AMPjs" width="117" height="52"></h1>
        </div>
        <div class="yui3-u-1-4 version">
            <em>API Docs for: 3.0.7</em>
        </div>
    </div>
    <div id="bd" class="yui3-g">

        <div class="yui3-u-1-4">
            <div id="docs-sidebar" class="sidebar apidocs">
                <div id="api-list">
                    <h2 class="off-left">APIs</h2>
                    <div id="api-tabview" class="tabview">
                        <ul class="tabs">
                            <li><a href="#api-classes">Classes</a></li>
                            <li><a href="#api-modules">Modules</a></li>
                        </ul>
                
                        <div id="api-tabview-filter">
                            <input type="search" id="api-filter" placeholder="Type to filter APIs">
                        </div>
                
                        <div id="api-tabview-panel">
                            <ul id="api-classes" class="apis classes">
                                <li><a href="../classes/AMP.$.html">AMP.$</a></li>
                                <li><a href="../classes/AMP.$.BoxHover.html">AMP.$.BoxHover</a></li>
                                <li><a href="../classes/AMP.$.Crossfader.html">AMP.$.Crossfader</a></li>
                                <li><a href="../classes/AMP.$.FlatHeight.html">AMP.$.FlatHeight</a></li>
                                <li><a href="../classes/AMP.$.Float3d.html">AMP.$.Float3d</a></li>
                                <li><a href="../classes/AMP.$.MediaImageChange.html">AMP.$.MediaImageChange</a></li>
                                <li><a href="../classes/AMP.$.Render.html">AMP.$.Render</a></li>
                                <li><a href="../classes/AMP.$.Rollover.html">AMP.$.Rollover</a></li>
                                <li><a href="../classes/AMP.$.Scroll.html">AMP.$.Scroll</a></li>
                                <li><a href="../classes/AMP.$.ScrollToggle.html">AMP.$.ScrollToggle</a></li>
                                <li><a href="../classes/AMP.$.Slider.html">AMP.$.Slider</a></li>
                                <li><a href="../classes/AMP.$.Slip.html">AMP.$.Slip</a></li>
                                <li><a href="../classes/AMP.$.SmoothScroll.html">AMP.$.SmoothScroll</a></li>
                                <li><a href="../classes/AMP.$.UIController.html">AMP.$.UIController</a></li>
                                <li><a href="../classes/AMP.Array.html">AMP.Array</a></li>
                                <li><a href="../classes/AMP.BASE_CLASS.html">AMP.BASE_CLASS</a></li>
                                <li><a href="../classes/AMP.Debug.html">AMP.Debug</a></li>
                                <li><a href="../classes/AMP.Ease.html">AMP.Ease</a></li>
                                <li><a href="../classes/AMP.Events.html">AMP.Events</a></li>
                                <li><a href="../classes/AMP.Extend.html">AMP.Extend</a></li>
                                <li><a href="../classes/AMP.FontResize.html">AMP.FontResize</a></li>
                                <li><a href="../classes/AMP.Has.html">AMP.Has</a></li>
                                <li><a href="../classes/AMP.Is.html">AMP.Is</a></li>
                                <li><a href="../classes/AMP.Loader.html">AMP.Loader</a></li>
                                <li><a href="../classes/AMP.Location.html">AMP.Location</a></li>
                                <li><a href="../classes/AMP.Mediaquery.html">AMP.Mediaquery</a></li>
                                <li><a href="../classes/AMP.Storage.html">AMP.Storage</a></li>
                                <li><a href="../classes/AMP.String.html">AMP.String</a></li>
                                <li><a href="../classes/AMP.Utility.html">AMP.Utility</a></li>
                                <li><a href="../classes/AMP.Vector.html">AMP.Vector</a></li>
                                <li><a href="../classes/Fallback.html">Fallback</a></li>
                                <li><a href="../classes/jQuery.html">jQuery</a></li>
                            </ul>
                
                            <ul id="api-modules" class="apis modules">
                            </ul>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <div class="yui3-u-3-4">
                <div id="api-options">
                    Show:
                    <label for="api-show-inherited">
                        <input type="checkbox" id="api-show-inherited" checked>
                        Inherited
                    </label>
            
                    <label for="api-show-protected">
                        <input type="checkbox" id="api-show-protected">
                        Protected
                    </label>
            
                    <label for="api-show-private">
                        <input type="checkbox" id="api-show-private">
                        Private
                    </label>
                    <label for="api-show-deprecated">
                        <input type="checkbox" id="api-show-deprecated">
                        Deprecated
                    </label>
            
                </div>
            
            <div class="apidocs">
                <div id="docs-main">
                    <div class="content">
<h1 class="file-heading">File: develop\amp\jquery\class\inherits\Crossfader.js</h1>

<div class="file">
    <pre class="code prettyprint linenums">
/// AMPjs Javascript Library
/// The MIT License (MIT)
/// author Yoshihito Fujiwara
/// source https://bitbucket.org/yoshihitofujiwara/ampjs
/// Copyright (c) 2014 Yoshihito Fujiwara

(function(root, AMP, $){

  // &#x27;use strict&#x27;;


  /*----------------------------------------------------------------------
    @constructor
  ----------------------------------------------------------------------*/

  /**
   * &lt;h4&gt;クロスフェーダー&lt;/h4&gt;
   * &lt;p&gt;&lt;a href=&quot;../../demo/AMP.$.Crossfader.html&quot;&gt;DEMO&lt;/a&gt;&lt;/p&gt;
   *
   * @constructor
   * @class AMP.$.Crossfader
   * @extends AMP.$.UIController
   * @param {jQuery} $crossfader クロスフェーダー要素
   * @param {Object} options オプション値
   */
  function Crossfader($crossfader, options){
    /**
     * &lt;h4&gt;プロパティオブジェクト&lt;/h4&gt;
     * &lt;p&gt;コンストラクタが呼び出し時に、引数とoptionsをmixinしてpropsオブジェクトに格納します&lt;/p&gt;
     *
     * @property props
     * @type {Object}
     */
    /**
     * &lt;h4&gt;クロスフェーダー要素&lt;/h4&gt;
     *
     * @property props.$wrap
     * @type {jQuery}
     */
    /**
     * &lt;h4&gt;アイテム要素数&lt;/h4&gt;
     *
     * @property props.length
     * @type {Number}
     */
    /**
     * &lt;h4&gt;タイマーID&lt;/h4&gt;
     *
     * @private
     * @property props._timerId
     * @type {String}
     */
    /**
     * &lt;h4&gt;アニメーション状態管理フラグ&lt;/h4&gt;
     *
     * @private
     * @property props._isAnimate
     * @type {Boolean}
     */
		this.props = $.extend(
			true,
			{},
			Crossfader.options,
			{
        $wrap         : $crossfader,
        $frame        : $crossfader.find(&#x27;.frame&#x27;),
        $item         : $crossfader.find(&#x27;.frame&#x27;).children(),
        $pointer      : $crossfader.find(&#x27;.pointer&#x27;),
        $thumbnail    : $crossfader.find(&#x27;.thumbnail a&#x27;),
        $prev         : $crossfader.find(&#x27;.prev a&#x27;),
        $next         : $crossfader.find(&#x27;.next a&#x27;),
        length        : $crossfader.find(&#x27;.frame&#x27;).children().length,
        _timerId      : null,
        _isAnimate    : false
			},
			options
		);
  }

  // AMP.$.UIControllerクラスを継承
  AMP.inherits(Crossfader, AMP.$.UIController);

  // prototype
  var p = Crossfader.prototype;



  /*--------------------------------------------------------------------------
    @property
  --------------------------------------------------------------------------*/

  /**
   * &lt;h4&gt;バージョン情報&lt;/h4&gt;
   *
   * @static
   * @property VERSION
   * @type {String}
   */
  Crossfader.VERSION = &#x27;1.0.0&#x27;;


  /**
   * &lt;h4&gt;クラス名&lt;/h4&gt;
   *
   * @property className
   * @type {String}
   */
  p.className = &#x27;Crossfader&#x27;;


  /**
   * &lt;h4&gt;デフォルト値オブジェクト&lt;/h4&gt;
   * &lt;p&gt;コンストラクタが呼び出し時に、引数とoptionsをmixinしてpropsオブジェクトに格納します&lt;/p&gt;
   *
   * @static
   * @property options
   * @type {Object}
   */
  /**
   * &lt;h4&gt;クロスフェーダーフレーム要素&lt;/h4&gt;
   *
   * @static
   * @property options.$frame
   * @default $crossfader.find(&#x27;.frame&#x27;)
   * @type {jQuery}
   */
  /**
   * &lt;h4&gt;クロスフェードするアイテム要素&lt;/h4&gt;
   *
   * @static
   * @property options.$item
   * @default $crossfader.find(&#x27;.frame&#x27;).children()
   * @type {jQuery}
   */
  /**
   * &lt;h4&gt;ポインター要素&lt;/h4&gt;
   *
   * @static
   * @property options.$pointer
   * @default $crossfader.find(&#x27;.pointer&#x27;)
   * @type {jQuery}
   */
  /**
   * &lt;h4&gt;サムネイル要素&lt;/h4&gt;
   *
   * @static
   * @property options.$thumbnail
   * @default $crossfader.find(&#x27;.thumbnail a&#x27;)
   * @type {jQuery}
   */
  /**
   * &lt;h4&gt;prevナビ要素&lt;/h4&gt;
   *
   * @static
   * @property options.$prev
   * @default $crossfader.find(&#x27;.prev a&#x27;)
   * @type {jQuery}
   */
  /**
   * &lt;h4&gt;nextナビ要素&lt;/h4&gt;
   *
   * @static
   * @property options.$next
   * @default $crossfader.find(&#x27;.next a&#x27;)
   * @type {jQuery}
   */
  /**
   * &lt;h4&gt;フリックイベントを有効にするか&lt;/h4&gt;
   *
   * @static
   * @property options.isFlick
   * @default true
   * @type {Boolean}
   */
  /**
   * &lt;h4&gt;クロスフェーダー要素にマウスオンされたときタイマーを無効にするか&lt;/h4&gt;
   *
   * @static
   * @property options.isTimerCancel
   * @default true
   * @type {Boolean}
   */
  /**
   * &lt;h4&gt;クロスフェードエリアの高さ調整機能を有効にするか&lt;/h4&gt;
   *
   * @static
   * @property options.isAutoHeight
   * @default false
   * @type {Boolean}
   */
  /**
   * &lt;h4&gt;現在アクティブなアイテムインデックス&lt;/h4&gt;
   *
   * @static
   * @property options.current
   * @default 0
   * @type {Number}
   */
  /**
   * &lt;h4&gt;クロスフェードタイマーの間隔&lt;/h4&gt;
   * &lt;p&gt;タイマー値が0の場合タイマーは実行しません&lt;/p&gt;
   *
   * @static
   * @property options.timer
   * @default 0
   * @type {Number}
   */
  /**
   * &lt;h4&gt;アクティブ要素に付与するクラス名&lt;/h4&gt;
   *
   * @static
   * @property options.activeClass
   * @default active
   * @type {String}
   */
  /**
   * &lt;h4&gt;リサイズ時に実行する関数&lt;/h4&gt;
   *
   * @static
   * @property options.resizeCall
   * @default $.noop
   * @type {Function}
   */
  /**
   * &lt;h4&gt;リサイズに完了時に実行する関数&lt;/h4&gt;
   *
   * @static
   * @property options.resizeStopCall
   * @default $.noop
   * @type {Function}
   */
  /**
   * &lt;h4&gt;クロスフェードアニメーションのオプション値&lt;/h4&gt;
   * &lt;p&gt;参照： &lt;a href=&quot;http://julian.com/research/velocity/#arguments&quot; target=&quot;_blank&quot;&gt;オプション値&lt;/a&gt;&lt;/p&gt;
   *
   * @static
   * @property options.tween
   * @type {Object}
   */
  Crossfader.options = {
    $frame        : null,
    $item         : null,
    $pointer      : null,
    $thumbnail    : null,
    $prev         : null,
    $next         : null,
    isFlick       : true,
    isResize      : true,
    isTimerCancel : true,
    isAutoHeight  : true,
    current       : 0,
    timer         : 0,
    activeClass   : &#x27;active&#x27;,
    resizeCall    : $.noop,
    resizeStopCall: $.noop,
    tween         : {
      easing      : &#x27;easeInSine&#x27;,
      duration    : 500,
      begin       : $.noop,
      progress    : $.noop,
      complete    : $.noop
    }
  };



  /*--------------------------------------------------------------------------
    @method
  --------------------------------------------------------------------------*/

  /**
   * &lt;h4&gt;Crossfaderインスタンスの生成&lt;/h4&gt;
   *
   * @static
   * @param {jQuery} $wrap   クロスフェード要素
   * @param {Object} options オプション値
   * @return {Crossfader}
   */
  Crossfader.get = function($crossfader, options){
    return new Crossfader($crossfader, options).init();
  };


  /**
   * &lt;h4&gt;初期化&lt;/h4&gt;
   * &lt;p&gt;Singleton&lt;/p&gt;
   *
   * @method  init
   * @return {Crossfader}
   */
  p.init = function(){
    // 初期化フラグ
    if(this._isInit){
      return this;
    }
    this._isInit = true;

    // view
    this.createPointer();

    // event
    this.addEventResize();
    this.addEventTimerCancel();
    this.addEventFlick(this.props.$frame);
    this.addEventNext(this.props.$next);
    this.addEventPrev(this.props.$prev);
    this.addEventPager(this.props.$thumbnail);
    this.addEventPager(this.props.$pointer.find(&#x27;a&#x27;));

    // view
    this.setIndex();
    this.active();

    return this;
  };


	/* Events
	-----------------------------------------------------------------*/
	/**
	 * &lt;h4&gt;リサイズイベント登録&lt;/h4&gt;
	 *
	 * @method addEventResize
	 * @return {Crossfader}
	 */
	p.addEventResize = function(){
		var self = this;

		$(window).off(&#x27;resize.Crossfader resizestop.Crossfader&#x27;)
		.on(&#x27;resize.Crossfader&#x27;, function(){
      if(self.props.isResize){
        self.timerStop();
        self.props.resizeCall();
      }
    })
    .on(&#x27;resizestop.Crossfader&#x27;, function(){
      if(self.props.isResize){
        self.timerStart();
        self.props.resizeStopCall();
      }
		});

		return this;
  };


  /**
   * &lt;h4&gt;タイマーキャンセルイベント登録&lt;/h4&gt;
   * &lt;p&gt;クロスフェーダーにマウスオンされた状態の時、タイマー処理をキャンセルします&lt;/p&gt;
   *
	 * @method addEventTimerCancel
	 * @return {Crossfader}
   */
  p.addEventTimerCancel = function(){
		var self = this;

		self.props.$wrap.off(&#x27;mouseenter.Crossfader mouseleave.Crossfader&#x27;)
		.on(&#x27;mouseenter.Crossfader&#x27;, function(){
			if(self.props.isTimerCancel){
				self.timerStop();
			}
		})
		.on(&#x27;mouseleave.Crossfader&#x27;, function(){
			if(self.props.isTimerCancel){
				self.timerStart();
			}
		});

		return this;
  };



  /* Controllers
  -----------------------------------------------------------------*/
	/**
	 * &lt;h4&gt;タイマースタート&lt;/h4&gt;
   * &lt;p&gt;タイマー値が0の場合タイマーは実行しません&lt;/p&gt;
	 *
	 * @method timerStart
	 * @param  {Number} num セットするタイマー値(省略可)
	 * @return {Crossfader}
	 */
	p.timerStart = function(num){
		var self = this;

		if(AMP.isNumber(num)){
			self.props.timer = num;
		}

		// タイマーをクリア
		self.timerStop();

		if(0 &lt; self.props.timer){
			self.props._timerId = setTimeout(function(){
				self.next();
			}, self.props.timer + self.props.tween.duration);
		}

		return this;
	};


	/**
	 * &lt;h4&gt;タイマー停止&lt;/h4&gt;
   *
	 * @method timerStop
	 * @return {Crossfader}
	 */
	p.timerStop = function(){
		clearTimeout(this.props._timerId);
		return this;
	};


	/**
	 * &lt;h4&gt;コントローラー&lt;/h4&gt;
   * &lt;p&gt;クロスフェードイベントが実行されたとき、必ずここの処理を通します&lt;/p&gt;
   *
   * @override
   * @private
	 * @method _controller
   * @param  {Number} index 表示するアイテムインデックス
	 * @param  {Boolean} nonAnimate アニメーション無
	 * @return {Void}
	 */
  p._controller = function(index, nonAnimate){
		var self = this;

    // アニメーションキャンセル
		if(self.props._isAnimate || self.props.current === index){
			return void 0;
		}

    // indexの調整
    if(index &lt; 0){
      index = self.props.length - 1;
    } else if(index &gt;= self.props.length){
      index = 0;
    }

    // パラメータ更新
    prev = self.props.current;
    self.props.current = index;

    // アニメート判定
    if(nonAnimate){
      self.setIndex();
      self.active();
    } else {
      $.sequence(
        function(){
          // フェード前
          self.props._isAnimate = true;
          self.timerStop();
          self.active();
        },
        function(){
          // フェード
          return self._tween(prev, self.props.current);
        },
        function(){
          // フェード後
          self.timerStart();
          self.props._isAnimate = false;
        }
      );
    }
  };


	/* Views
	-----------------------------------------------------------------*/
	/**
	 * &lt;h4&gt;ポインターの生成&lt;/h4&gt;
	 *
	 * @method createPointer
	 * @return {Crossfader}
	 */
  p.createPointer = function(){
		if(this.props.$pointer[0]){
			var pointerHTML = this.props.$pointer.find(&#x27;&gt;&#x27;)[0].outerHTML,
			print = &#x27;&#x27;,
			i = 0;

      for(; i &lt; this.props.length; i += 1){
        print += pointerHTML;
			}
			this.props.$pointer[0].innerHTML = print;
		}

		return this;
  };


  /**
   * &lt;h4&gt;要素のアクティブ化&lt;/h4&gt;
   *
   * @method active
   * @return {Crossfader}
   */
  p.active = function(){
    // $item
    this.props.$item.removeClass(this.props.activeClass)
    .eq(this.props.current).addClass(this.props.activeClass);

    // $thumbnail
    if(this.props.$thumbnail[0]){
      this.props.$thumbnail.removeClass(this.props.activeClass)
      .eq(this.props.current).addClass(this.props.activeClass);
    }

		// $pointer
		if(this.props.$pointer[0]){
			this.props.$pointer.children().removeClass(this.props.activeClass)
			.eq(this.props.current).addClass(this.props.activeClass);
		}

		// $next
		if(this.props.current === this.props.length - 1){
      this.props.$next.addClass(this.props.activeClass);
		} else {
			this.props.$next.removeClass(this.props.activeClass);
		}

		// $prev
		if(this.props.current === 0){
			this.props.$prev.addClass(this.props.activeClass);
		} else {
			this.props.$prev.removeClass(this.props.activeClass);
		}

		return this;
  };


  /**
   * &lt;h4&gt;クロスフェードアイテムの高さに揃える&lt;/h4&gt;
   *
   * @method autoHeight
   * @return {Crossfader}
   */
  p.autoHeight = function(){
    var height = this.props.$item.eq(this.props.current).height();
    this.props.$frame.height(height);
    return this;
  };


 /**
  * &lt;h4&gt;クロスフェードアイテムのスタイル設定&lt;/h4&gt;
  *
  * @method setIndex
  * @return {Crossfader}
  */
  p.setIndex = function(){
    this.props.$item.velocity(&#x27;stop&#x27;)
    .css({display: &#x27;none&#x27;, zIndex: 1, opaciy: 0})
    .eq(this.props.current)
    .css({display: &#x27;block&#x27;, zIndex: this.props.length, opaciy: 1});

    if(this.props.isAutoHeight){
      this.autoHeight();
    }

    return this;
  };


	/**
	 * &lt;h4&gt;クロスフェードアニメーションを実行&lt;/h4&gt;
	 *
	 * @private
	 * @method _tween
   * @param {Number} prev 前の要素
   * @param {Number} next 次の要素
	 * @return {jQuery.Deferred}
	 */
	p._tween = function(prev, next){
    // prev hide
    this.props.$item.velocity(&#x27;stop&#x27;)
    .eq(prev).velocity({opacity: 0, zIndex: 1}, {
      easing  : this.props.tween.easing,
      duration: this.props.tween.duration,
      display : &#x27;none&#x27;
    });

    this.props.$item.eq(next).css({display: &#x27;block&#x27;,zIndex: this.props.length, opacity: 0});

    if(this.props.isAutoHeight){
      this.autoHeight();
    }

    // next show
		return this.props.$item.eq(next).velocity({opacity: 1}, this.props.tween);
	};



  /*--------------------------------------------------------------------------
    export
  --------------------------------------------------------------------------*/

  AMP.$.Crossfader = Crossfader;


}(window, AMP, jQuery));

    </pre>
</div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
<script src="../assets/vendor/prettify/prettify-min.js"></script>
<script>prettyPrint();</script>
<script src="../assets/js/yui-prettify.js"></script>
<script src="../assets/../api.js"></script>
<script src="../assets/js/api-filter.js"></script>
<script src="../assets/js/api-list.js"></script>
<script src="../assets/js/api-search.js"></script>
<script src="../assets/js/apidocs.js"></script>
</body>
</html>
