<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>develop\amp\jquery\utilities\Slider.js - AMP.js</title>
    <link rel="stylesheet" href="http://yui.yahooapis.com/3.9.1/build/cssgrids/cssgrids-min.css">
    <link rel="stylesheet" href="../assets/vendor/prettify/prettify-min.css">
    <link rel="stylesheet" href="../assets/css/main.css" id="site_styles">
    <link rel="icon" href="../assets/favicon.ico">
    <script src="http://yui.yahooapis.com/combo?3.9.1/build/yui/yui-min.js"></script>
</head>
<body class="yui3-skin-sam">

<div id="doc">
    <div id="hd" class="yui3-g header">
        <div class="yui3-u-3-4">
                <h1><img src="../assets/css/logo.png" title="AMP.js" width="117" height="52"></h1>
        </div>
        <div class="yui3-u-1-4 version">
            <em>API Docs for: 3.0.0</em>
        </div>
    </div>
    <div id="bd" class="yui3-g">

        <div class="yui3-u-1-4">
            <div id="docs-sidebar" class="sidebar apidocs">
                <div id="api-list">
                    <h2 class="off-left">APIs</h2>
                    <div id="api-tabview" class="tabview">
                        <ul class="tabs">
                            <li><a href="#api-classes">Classes</a></li>
                            <li><a href="#api-modules">Modules</a></li>
                        </ul>
                
                        <div id="api-tabview-filter">
                            <input type="search" id="api-filter" placeholder="Type to filter APIs">
                        </div>
                
                        <div id="api-tabview-panel">
                            <ul id="api-classes" class="apis classes">
                                <li><a href="../classes/AMP.$.BoxHover.html">AMP.$.BoxHover</a></li>
                                <li><a href="../classes/AMP.$.FlatHeight.html">AMP.$.FlatHeight</a></li>
                                <li><a href="../classes/AMP.$.Float3d.html">AMP.$.Float3d</a></li>
                                <li><a href="../classes/AMP.$.LiquidSlider.html">AMP.$.LiquidSlider</a></li>
                                <li><a href="../classes/AMP.$.Loader.html">AMP.$.Loader</a></li>
                                <li><a href="../classes/AMP.$.Render.html">AMP.$.Render</a></li>
                                <li><a href="../classes/AMP.$.Rollover.html">AMP.$.Rollover</a></li>
                                <li><a href="../classes/AMP.$.Scroll.html">AMP.$.Scroll</a></li>
                                <li><a href="../classes/AMP.$.ScrollToggle.html">AMP.$.ScrollToggle</a></li>
                                <li><a href="../classes/AMP.$.Slider.html">AMP.$.Slider</a></li>
                                <li><a href="../classes/AMP.$.SmoothScroll.html">AMP.$.SmoothScroll</a></li>
                                <li><a href="../classes/AMP.$.UIController.html">AMP.$.UIController</a></li>
                                <li><a href="../classes/AMP.Array.html">AMP.Array</a></li>
                                <li><a href="../classes/AMP.BASE_CLASS.html">AMP.BASE_CLASS</a></li>
                                <li><a href="../classes/AMP.CJS.Polygon.html">AMP.CJS.Polygon</a></li>
                                <li><a href="../classes/AMP.Debug.html">AMP.Debug</a></li>
                                <li><a href="../classes/AMP.Ease.html">AMP.Ease</a></li>
                                <li><a href="../classes/AMP.Events.html">AMP.Events</a></li>
                                <li><a href="../classes/AMP.Extend.html">AMP.Extend</a></li>
                                <li><a href="../classes/AMP.FontResize.html">AMP.FontResize</a></li>
                                <li><a href="../classes/AMP.Has.html">AMP.Has</a></li>
                                <li><a href="../classes/AMP.Is.html">AMP.Is</a></li>
                                <li><a href="../classes/AMP.Location.html">AMP.Location</a></li>
                                <li><a href="../classes/AMP.Mediaquery.html">AMP.Mediaquery</a></li>
                                <li><a href="../classes/AMP.Model.html">AMP.Model</a></li>
                                <li><a href="../classes/AMP.Storage.html">AMP.Storage</a></li>
                                <li><a href="../classes/AMP.String.html">AMP.String</a></li>
                                <li><a href="../classes/AMP.Utility.html">AMP.Utility</a></li>
                                <li><a href="../classes/Fallback.html">Fallback</a></li>
                                <li><a href="../classes/jQuery.html">jQuery</a></li>
                            </ul>
                
                            <ul id="api-modules" class="apis modules">
                            </ul>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <div class="yui3-u-3-4">
                <div id="api-options">
                    Show:
                    <label for="api-show-inherited">
                        <input type="checkbox" id="api-show-inherited" checked>
                        Inherited
                    </label>
            
                    <label for="api-show-protected">
                        <input type="checkbox" id="api-show-protected">
                        Protected
                    </label>
            
                    <label for="api-show-private">
                        <input type="checkbox" id="api-show-private">
                        Private
                    </label>
                    <label for="api-show-deprecated">
                        <input type="checkbox" id="api-show-deprecated">
                        Deprecated
                    </label>
            
                </div>
            
            <div class="apidocs">
                <div id="docs-main">
                    <div class="content">
<h1 class="file-heading">File: develop\amp\jquery\utilities\Slider.js</h1>

<div class="file">
    <pre class="code prettyprint linenums">
var AMP = AMP || {};


(function(root, $){

  // &#x27;use strict&#x27;;


  /*----------------------------------------------------------------------
    @constructor
  ----------------------------------------------------------------------*/

  /**
   * &lt;h4&gt;スライダー&lt;/h4&gt;
   * velocity.jsに依存しています
   *
   * @constructor
   * @class AMP.$.Slider
   * @param {jQuery} $slider スライダー要素
   * @param {Object} options オプション値
   */
  function Slider($slider, options){
    /**
     * &lt;h4&gt;プロパティ格納オブジェクト&lt;/h4&gt;
     *
     * @property param
     * @type {Object}
     */
    /**
     * &lt;h4&gt;スライダー要素&lt;/h4&gt;
     *
     * @property param.$wrap
     * @type {jQuery}
     */
    /**
     * &lt;h4&gt;スライダーアイテム要素数&lt;/h4&gt;
     *
     * @property param.length
     * @type {Number}
     */
    /**
     * &lt;h4&gt;表示されてる要素数&lt;/h4&gt;
     *
     * @property param.displayLength
     * @type {Number}
     */
    /**
     * &lt;h4&gt;$frame内に表示されている要素数&lt;/h4&gt;
     *
     * @property param.visible
     * @type {Number}
     */
    /**
     * &lt;h4&gt;スライドする距離&lt;/h4&gt;
     *
     * @property param.distance
     * @type {Number}
     */
    /**
     * &lt;h4&gt;left値&lt;/h4&gt;
     *
     * @property param.left
     * @type {Number}
     */
    /**
     * &lt;h4&gt;タイマーID&lt;/h4&gt;
     *
     * @private
     * @property param._timerId
     * @type {String}
     */
    /**
     * &lt;h4&gt;アニメーション状態管理フラグ&lt;/h4&gt;
     *
     * @private
     * @property param._isAnimate
     * @type {Boolean}
     */
		this.param = $.extend(
			true,
			{},
			Slider.sliderOptions,
			{
				$wrap        : $slider,
				$frame       : $slider.find(&#x27;.frame&#x27;),
				$slide       : $slider.find(&#x27;.slide&#x27;),
				$slideItems  : $slider.find(&#x27;.slide&#x27;).children(),
				$pointer     : $slider.find(&#x27;.pointer&#x27;),
				$thumbnail   : $slider.find(&#x27;.thumbnail a&#x27;),
				$prev        : $slider.find(&#x27;.prev a&#x27;),
				$next        : $slider.find(&#x27;.next a&#x27;),
				length       : $slider.find(&#x27;.slide&#x27;).children().length,
				displayLength: 0,
				visible      : 0,
				distance     : 0,
				left         : 0,
        slideMaxCount: 0,
				_timerId     : null,
				_isAnimate   : false
			},
			options
		);

		if(this.param.isInit){
			this.init();
		}
  }

  // 基底クラスを継承
  AMP.inherits(Slider, AMP.$.UIController);

  // prototype
  var p = Slider.prototype;



  /*--------------------------------------------------------------------------
    @property
  --------------------------------------------------------------------------*/

  /**
   * &lt;h4&gt;バージョン情報&lt;/h4&gt;
   *
   * @static
   * @property VERSION
   * @type {String}
   */
  Slider.VERSION = &#x27;1.0.0&#x27;;


  /**
   * &lt;h4&gt;クラス名&lt;/h4&gt;
   *
   * @property className
   * @type {String}
   */
  p.className = &#x27;Slider&#x27;;


  /**
   * &lt;h4&gt;デフォルト値、格納オブジェクト&lt;/h4&gt;
   * コンストラクタが呼び出された際に、option値とmixinしてparamに格納します。
   *
   * @static
   * @property sliderOptions
   * @type {Object}
   */
  /**
   * &lt;h4&gt;スライダーフレーム要素&lt;/h4&gt;
   *
   * @property sliderOptions.$frame
   * @type {jQuery}
   */
  /**
   * &lt;h4&gt;スライドする要素&lt;/h4&gt;
   *
   * @property sliderOptions.$slide
   * @type {jQuery}
   */
  /**
   * &lt;h4&gt;スライドする子要素&lt;/h4&gt;
   *
   * @property sliderOptions.$slideItems
   * @type {jQuery}
   */
  /**
   * &lt;h4&gt;ポインター要素&lt;/h4&gt;
   *
   * @property sliderOptions.$pointer
   * @type {jQuery}
   */
  /**
   * &lt;h4&gt;サムネイル要素&lt;/h4&gt;
   *
   * @property sliderOptions.$thumbnail
   * @type {jQuery}
   */
  /**
   * &lt;h4&gt;prevナビ要素&lt;/h4&gt;
   *
   * @property sliderOptions.$prev
   * @type {jQuery}
   */
  /**
   * &lt;h4&gt;nextナビ要素&lt;/h4&gt;
   *
   * @property sliderOptions.$next
   * @type {jQuery}
   */
  /**
   * &lt;h4&gt;コンストラクタ呼び出されたときに、スライダーを初期化するか&lt;/h4&gt;
   *
   * @property sliderOptions.isInit
   * @type {Boolean}
   */
  /**
   * &lt;h4&gt;フリックイベントを有効にするか&lt;/h4&gt;
   *
   * @property sliderOptions.isFlick
   * @type {Boolean}
   */
  /**
   * &lt;h4&gt;スライドループを有効にするか&lt;/h4&gt;
   *
   * @property sliderOptions.isLoop
   * @type {Boolean}
   */
  /**
   * &lt;h4&gt;スライダー要素にマウスオンされたときタイマーを無効にするか&lt;/h4&gt;
   *
   * @property sliderOptions.isTimerCancel
   * @type {Boolean}
   */
  /**
   * &lt;h4&gt;現在アクティブなスライドアイテムインデックス&lt;/h4&gt;
   *
   * @property sliderOptions.current
   * @type {Number}
   */
  /**
   * &lt;h4&gt;スライドステップ数を固定したい場合、ステップ数の指定&lt;/h4&gt;
   *
   * @property sliderOptions.slideStep
   * @type {Number}
   */
  /**
   * &lt;h4&gt;スライドタイマーの間隔&lt;/h4&gt;
   *
   * @property sliderOptions.timer
   * @type {Number}
   */
  /**
   * &lt;h4&gt;スライドduration&lt;/h4&gt;
   *
   * @property sliderOptions.duration
   * @type {Number}
   */
  /**
   * &lt;h4&gt;スライドease&lt;/h4&gt;
   *
   * @property sliderOptions.ease
   * @type {String}
   */
  /**
   * &lt;h4&gt;アクティブ要素に付与するクラス名&lt;/h4&gt;
   *
   * @property sliderOptions.activeClass
   * @type {String}
   */
  /**
   * &lt;h4&gt;スライド前に実行する関数&lt;/h4&gt;
   *
   * @property sliderOptions.tweenBegin
   * @type {Function}
   */
  /**
   * &lt;h4&gt;スライド完了時に実行する関数&lt;/h4&gt;
   *
   * @property sliderOptions.tweenCompleat
   * @type {Function}
   */
  /**
   * &lt;h4&gt;リサイズ時に実行する関数&lt;/h4&gt;
   *
   * @property sliderOptions.resizeCall
   * @type {Function}
   */
  /**
   * &lt;h4&gt;リサイズに完了時に実行する関数&lt;/h4&gt;
   *
   * @property sliderOptions.resizeStopCall
   * @type {Function}
   */
  Slider.sliderOptions = {
    $frame        : null,
    $slide        : null,
    $slideItems   : null,
    $pointer      : null,
    $thumbnail    : null,
    $prev         : null,
    $next         : null,
    isInit        : true,
    isFlick       : true,
    isLoop        : true,
    isResize      : false,
    isTimerCancel : true,
    current       : 0,
    slideStep     : 0,
    timer         : 0,
    duration      : 500,
    ease          : &#x27;easeOutQuart&#x27;,
    activeClass   : &#x27;active&#x27;,
    tweenBegin    : $.noop,
    tweenCompleat : $.noop,
    resizeCall    : $.noop,
    resizeStopCall: $.noop
  };



  /*--------------------------------------------------------------------------
    @method
  --------------------------------------------------------------------------*/

  /**
   * &lt;h4&gt;Sliderインスタンスの生成&lt;/h4&gt;
   *
   * @static
   * @class AMP.$.Slider
   * @param {jQuery} $wrap   スライダー要素
   * @param {Object} options オプション値
   * @return {Slider}
   */
  Slider.get = function($slider, options){
    return new Slider($slider, options);
  };


  /**
   * &lt;h4&gt;初期化&lt;/h4&gt;
   * Singleton
   *
   * @method  init
   * @return {Slider}
   */
  p.init = function(){
    var self = this;

    if(this._isInit){
      return this;
    }

		// param
		self.setParam();

		// view
		self._createPointer();
		self.setPosition();
		self.active();

		// event
		self.addEventResize();
		self.addEventTimerCancel();
    self.addEventFlick(self.param.$slide);
    self.addEventNext(self.param.$next);
    self.addEventPrev(self.param.$prev);
    self.addEventPager(self.param.$thumbnail);
    self.addEventPager(self.param.$pointer.find(&#x27;a&#x27;));

		// timer
		self.timerStart();

    // 初期化フラグ
    this._isInit = true;

    return this;
  };


  /**
   * &lt;h4&gt;パラメーターの設定&lt;/h4&gt;
   *
   * @method setParam
   * @return {Slider}
   */
  p.setParam = function(){
    var self = this,
    stageWidth, itemWidth, visible;

    // ステージの幅
		stageWidth = self.param.$frame.width();

		// アイテム要素の幅
		itemWidth = self.param.$slideItems.outerWidth(true);

		// 表示エリアにある要素数
		visible = ~~(stageWidth / itemWidth);

		// 移動距離
    // スライドステップ指定時は、ステップ数がフレーム内に収まっている場合のみ設定する
		if(0 &lt; self.param.slideStep &amp;&amp; self.param.slideStep &lt;= visible){
			self.param.distance = self.param.slideStep * itemWidth;
		} else {
			self.param.distance = visible * itemWidth;
		}

    // インデックス値
    if(self.param.visible &lt; visible){
      self.param.current = Math.ceil(self.param.current / visible);
    } else {
      self.param.current = Math.ceil(self.param.current * visible);
    }

    // 表示エリアにある要素数
    self.param.visible = visible;

    // アイテム要素の表示数
    self.param.displayLength = self.getDisplayLength();

    // スライド最大数
    if(0 &lt; self.param.slideStep){
      self.param.slideMaxCount = Math.ceil(self.param.displayLength / self.param.slideStep) - (self.param.visible - self.param.slideStep);
    } else {
      self.param.slideMaxCount = Math.ceil(self.param.displayLength / self.param.visible);
    }

    return this;
  };


	/* Events
	-----------------------------------------------------------------*/
	/**
	 * &lt;h4&gt;リサイズイベント&lt;/h4&gt;
	 *
	 * @method addEventResize
	 * @return {Slider}
	 */
	p.addEventResize = function(){
		var self = this;

		$(window).off(&#x27;resize.Slider resizestop.Slider&#x27;)
		.on(&#x27;resize.Slider&#x27;, function(){
      if(self.param.isResize){
  			self.timerStop();
  			self.setParam();
  			self.setPosition();
        self.param.resizeCall(self.param);
      }
    })
    .on(&#x27;resizestop.Slider&#x27;, function(){
      if(self.param.isResize){
        self._createPointer();
        self.addEventPager(self.param.$pointer.find(&#x27;a&#x27;));
        self.active();
        self.timerStart();
        self.param.resizeStopCall(self.param);
      }
		});

		return this;
  };


  /**
   * &lt;h4&gt;タイマーキャンセルイベント&lt;/h4&gt;
   * スライダーにマウスオンされた状態の時、タイマー処理をキャンセルします
   *
	 * @method addEventTimerCancel
	 * @return {Slider}
   */
  p.addEventTimerCancel = function(){
		var self = this;

		self.param.$wrap.off(&#x27;mouseenter.Slider mouseleave.Slider&#x27;)
		.on(&#x27;mouseenter.Slider&#x27;, function(){
			if(self.param.isTimerCancel){
				self.timerStop();
			}
		})
		.on(&#x27;mouseleave.Slider&#x27;, function(){
			if(self.param.isTimerCancel){
				self.timerStart();
			}
		});

		return this;
  };


  /**
   * &lt;h4&gt;フリックイベント&lt;/h4&gt;
   *
   * @method addEventFlick
   * @return {Slider}
   */
	p.addEventFlick = function($trigger){
		var self = this;

		$trigger.off(&#x27;flickmoveX.Slider flickcancelX.Slider flickX.Slider&#x27;)
		.on(&#x27;flickmoveX.Slider&#x27;, function(event){
			self._move(event.moveX);
		})
		.on(&#x27;flickcancelX.Slider&#x27;, function(){
			self._resetTween();
		})
		.on(&#x27;flickX.Slider&#x27;, function(event){
			if(0 &lt; event.moveX){
				self.prev();
			} else {
				self.next();
			}
		});

		return this;
	};


  /* Controllers
  -----------------------------------------------------------------*/
	/**
	 * &lt;h4&gt;タイマースタート&lt;/h4&gt;
	 *
	 * @method timerStart
	 * @param  {Number} num セットするタイマー値(省略可)
	 * @return {Slider}
	 */
	p.timerStart = function(num){
		var self = this;

		if(AMP.isNumber(num)){
			self.param.timer = num;
		}

		// タイマーをクリア
		self.timerStop();

		if(0 &lt; self.param.timer){
			self.param._timerId = setTimeout(function(){
				self.next();
			}, self.param.timer + self.param.duration);
		}

		return this;
	};


	/**
	 * タイマー停止
	 * @method timerStop
	 * @return {Slider}
	 */
	p.timerStop = function(){
		clearTimeout(this.param._timerId);
		return this;
	};


	/**
	 *&lt;h4&gt; コントローラー&lt;/h4&gt;
	 *
   * @private
	 * @method _controller
	 * @param  {Number} step スライドするステップ数
	 * @return {Void}
	 */
  p._controller = function(step, isIndex){
		var self = this;

		if(self.param._isAnimate){
			return void 0;
		}

    // stepの調整
    if(isIndex){
      step = step &lt; self.param.slideMaxCount ? step : self.param.slideMaxCount - 1;
    } else {
      step = self.param.current + step;
    }

    //
    if(-1 &lt; step &amp;&amp; step &lt; self.param.slideMaxCount){
      self.param.current = step;
    } else {
      if(self.param.isLoop){
        self.param.current = -1 &lt; step ? step - self.param.slideMaxCount : self.param.slideMaxCount + step;
      } else {
        return void 0;
      }
    }

		self.param._isAnimate = true;
		self.param.left = self.param.current * self.param.distance * -1;

		$.sequence(
      function(){
  			// スライド前のコールバック実行
				self.timerStop();
				self.active();
				return self.param.tweenBegin(self.param);
			},
      function(){
	   		// スライドとコールバック実行
				return self._tween();
			},
      function(){
  			// スライド完了コールバック
				return self.param.tweenCompleat(self.param);
			},
			function(){
				self.timerStart();
				self.param._isAnimate = false;
			}
		);
  };


	/* Views
	-----------------------------------------------------------------*/
  /**
   * &lt;h4&gt;表示可能な要素の数を取得&lt;/h4&gt;
   *
   * @method getDisplayLength
   * @return {Number}
   */
  p.getDisplayLength = function(){
    var count = 0;
    this.param.$slideItems.each(function(){
      if($(this).css(&#x27;display&#x27;) !== &#x27;none&#x27;){
        count += 1;
      }
    });
    return count;
  };


	/**
	 * &lt;h4&gt;ポインターの生成&lt;/h4&gt;
	 *
	 * @private
	 * @method _createPointer
	 * @return {Slider}
	 */
  p._createPointer = function(){
		if(this.param.$pointer[0]){
			var pointerHTML = this.param.$pointer.find(&#x27;&gt;&#x27;)[0].outerHTML,
			print = &#x27;&#x27;,
			i = 0;

			for(; i &lt; this.param.slideMaxCount; i += 1){
				print += pointerHTML;
			}
			this.param.$pointer[0].innerHTML = print;
		}

		return this;
  };


  /**
   * ここ途中
   * [setPosition description]
   */
  p.setPosition = function(){
    this.param.$slide.css({
      width: this.param.displayLength * this.param.$slideItems.outerWidth(true),
      left : this.param.left
    });
		return this;
  };


  /**
   * &lt;h4&gt;要素のアクティブ化&lt;/h4&gt;
   *
   * @method active
   * @return {Slider}
   */
  p.active = function(){
    var index;

    if(0 &lt; this.param.slideStep){
      index = this.param.current * this.param.slideStep;
    } else {
      index = this.param.current * this.param.visible;
    }

    // $slideItems
    this.param.$slideItems.removeClass(this.param.activeClass)
    .slice(index, index + this.param.visible)
    .addClass(this.param.activeClass);

    // $thumbnail
    if(this.param.$thumbnail[0]){
      this.param.$thumbnail.removeClass(this.param.activeClass)
      .slice(index, index + this.param.visible).addClass(this.param.activeClass);
    }

		// $pointer
		if(this.param.$pointer[0]){
			this.param.$pointer.children().removeClass(this.param.activeClass)
			.eq(this.param.current).addClass(this.param.activeClass);
		}

		// $next
		if(this.param.current === this.param.slideMaxCount - 1){
			this.param.$next.addClass(this.param.activeClass);
		} else {
			this.param.$next.removeClass(this.param.activeClass);
		}

		// $prev
		if(this.param.current === 0){
			this.param.$prev.addClass(this.param.activeClass);
		} else {
			this.param.$prev.removeClass(this.param.activeClass);
		}

		return this;
  };


  /**
   * &lt;h4&gt;指定x座標分移動&lt;/h4&gt;
   *
   * @private
   * @method _move
   * @param  {Number} x 移動するx座標値
   * @return {Void}
   */
  p._move = function(x){
		this.param.$slide.velocity(&#x27;stop&#x27;).css({left: this.param.left + x});
  };


  /**
   * &lt;h4&gt;スライド位置を戻す&lt;/h4&gt;
   *
   * @private
   * @method _resetTween
   * @return {jQuery.Deferred}
   */
  p._resetTween = function(){
		return this.param.$slide.velocity(&#x27;stop&#x27;)
    .velocity({left: this.param.left}, this.param.duration / 2, this.param.ease);
  };


	/**
	 * &lt;h4&gt;スライドアニメーションを実行&lt;/h4&gt;
	 *
	 * @private
	 * @method _tween
	 * @return {jQuery.Deferred}
	 */
	p._tween = function(){
		return this.param.$slide.velocity(&#x27;stop&#x27;)
    .velocity({left: this.param.left}, this.param.duration, this.param.ease);
	};



  /*--------------------------------------------------------------------------
    exports
  --------------------------------------------------------------------------*/

  AMP.$ = AMP.$ || {};
  AMP.$.Slider = Slider;


}(window, jQuery));

    </pre>
</div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
<script src="../assets/vendor/prettify/prettify-min.js"></script>
<script>prettyPrint();</script>
<script src="../assets/js/yui-prettify.js"></script>
<script src="../assets/../api.js"></script>
<script src="../assets/js/api-filter.js"></script>
<script src="../assets/js/api-list.js"></script>
<script src="../assets/js/api-search.js"></script>
<script src="../assets/js/apidocs.js"></script>
</body>
</html>
